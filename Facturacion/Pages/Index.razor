@page "/"
@using Microsoft.AspNetCore.Mvc


<PageTitle>Facturacion</PageTitle>

<div class="body-form">
    <div class="form-container">
        <div class="title">Facturación</div>
        <EditForm Model="@FacturaD" OnValidSubmit="@HandleValidConfirm">
            <DataAnnotationsValidator />
            <div class="user-details">
                <div class="box">
                    <div class="input-box">
                        <span class="details"> Cliente </span>
                        <!--filled by db-->
                        <input type="number" list="idCliente" />
                        <datalist id="idCliente">
                            <option value="01"></option>
                        </datalist>
                    </div>
                    <div class="input-box">
                        <span class="details">Nombre del cliente</span>
                        <!--filled by the current client-->
                        <input type="text" @bind="@Nombre" />
                    </div>
                    <div class="input-box">
                        <span class="details"> Tipo de Comprobante </span>
                        <select @bind="@TipoFactura">
                            <option value="1" selected>Credito Fiscal</option>
                            <option value="2">Consumo</option>
                            <option value="3">Nota de Debito</option>
                            <option value="4">Nota de Credito</option>
                            <option value="5">Régimen especiales</option>
                            <option value="6">Gubernamental</option>
                        </select>
                    </div>
                    <div class="input-box">
                        <span class="details"> Secuencia Fiscal </span>
                        <input type="text" @bind="@SecFiscal" />
                    </div>
                </div>
                <div class="box">
                    <div class="input-box">
                        <span class="details"> Fecha factura </span>
                        @{
                            string min = string.Format("{0}-{1}-{2}", DateTime.Now.Year, DateTime.Now.Month, DateTime.Now.Day);
                        }
                        <input class="input-date" type="date" min="@min" @bind="@FechaGenerada" />
                    </div>
                    <div class="input-box">
                        <span class="details"> Moneda </span>
                        <select @bind="@IdMoneda">
                            <option value="1" selected>DOP</option>
                            <option value="2">USD</option>
                        </select>
                    </div>
                    @if (TipoFactura == 2)
                    {
                        <div class="input-box">
                            <span class="details"> Metodo de Pago </span>
                            <select>
                                <option value="1" selected>Efectivo</option>
                                <option value="2">Tarjeta</option>
                            </select>
                        </div>
                    }
                    @if (TipoFactura == 1 || TipoFactura == 4 || TipoFactura == 5 || TipoFactura == 6)
                    {
                        <div class="input-box">
                            <span class="details"> Dias credito </span>
                            <select @bind="@IdDiasCredito">
                                <option value="1" selected>30 Dias</option>
                                <option value="2">60 Dias</option>
                                <option value="3">90 Dias</option>
                                <option value="4">120 Dias</option>
                            </select>
                        </div>
                    }
                </div>
            </div>
            <div class="facturables">
                
            </div>
            <hr />
            <div class="button">
                <button type="submit">Confirmar</button>
            </div>
        </EditForm>
    </div>
</div>
@code {
    [BindProperty]
    public short IdCliente { get; set; }
    [BindProperty]
    public string Nombre { get; set; } = "";
    [BindProperty]
    public byte IdMoneda { get; set; }
    [BindProperty]
    public DateTime FechaGenerada { get; set; } = DateTime.Now;
    [BindProperty]
    public byte TipoFactura { get; set; }
    [BindProperty]
    public string SecFiscal { get; set; } = "";
    [BindProperty]
    public byte IdDiasCredito { get; set; }

    public FacturasD? FacturaD { get; set; } = new();

    public void HandleValidConfirm()
    {
        Nombre = "Test";
    }
}